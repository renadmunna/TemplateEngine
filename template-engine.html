<!DOCTYPE html>
<html>
<body>
	<div class="view" id="a">
		<div id="${id}">${text} ${bl} ${a['b'].c} ${a["b"].c} ${n[0]} ${m[1]}</div>
	</div>
<script>
function test(label,itr,func){
	console.time(label);
	for(var i=0;i<itr;i++){ func() }
	console.timeEnd(label);
}
var dom=document.querySelector.bind(document);
var doms=document.querySelectorAll.bind(document);

HTMLElement.prototype.attr=function(){
return arguments.length==1 && this.getAttribute(arguments[0])
	|| arguments.length==2 && this.setAttribute(arguments[0],arguments[1]);
};
EventTarget.prototype.on = EventTarget.prototype.addEventListener;
EventTarget.prototype.trigger = EventTarget.prototype.dispatchEvent;

// (value,index,obj)=>
NodeList.prototype.each=NodeList.prototype.forEach;
Array.prototype.each=Array.prototype.forEach;
Object.prototype.each=function(func){obj=this;
	for(const key in obj){if(obj.hasOwnProperty(key)&&func){func(obj[key],key,obj)}}
};

function render0(template,data){
	var tpl = template.replace(/\${(?!this\.)/g, "${this.");
	return new Function(`return \`${tpl}\``).call(data);
	// return new Function('return `'+tpl+'`;').call(data);
}

// single level
// var render1es6=(tpl,data)=>tpl.replace(/\${(.*?)}/g,(x,g)=>data[g]);
var render1=function(tpl,data){return tpl.replace(/\${(.*?)}/g,function(x,g){return data[g]})};
// multi level
// var renderes6=(tpl,data)=>tpl.replace(/\${(.*?)}/g,(x,g)=>g.split(/[\.\[\]\'\"]/g).filter(Boolean).reduce((o,i)=>o[i],data));
var render=function(tpl,data){return tpl.replace(/\${(.*?)}/g,function(x,g){
	return g.split(/[\.\[\]\'\"]/g).filter(Boolean).reduce(function(obj,i){return obj[i]},data)
})};

String.prototype.render=function(data){return this.replace(/\${(.*?)}/g,function(x,g){
	return g.split(/[\.\[\]\'\"]/g).filter(Boolean).reduce(function(obj,i){return obj[i]},data)
})};


HTMLElement.prototype._render=function(data){that=this;
	that.template=that.template||that.innerHTML;that.renderHTML='';
	if(Array.isArray(data)){
		data.each(function(item){
			that.renderHTML+=that.template.render(item)
		});
	}
	else{that.renderHTML+=that.template.render(data)}
};
HTMLElement.prototype.render=function(data){this._render(data);
	this.innerHTML=this.renderHTML;
};
HTMLElement.prototype.renderAfter=function(data){this._render(data);
	this.innerHTML+=this.renderHTML;
};
HTMLElement.prototype.renderBefore=function(data){this._render(data);
	this.innerHTML=this.renderHTML+this.innerHTML;
};



// setTimeout(function(){
	var data=[
		{id:143,text:'hello',bl:true,a:{b:{c:'renad'}},n:['a1','b1'],m:{1:'munna'}},
		{id:144,text:'renad munna',bl:false,a:{b:{c:'ali'}},n:['a4','b4'],m:{1:'anni'}}
	];
	// console.log(dom('#a').innerHTML.render(data));
	// dom('#a').render(data);
	// console.log(Object.keys(data));
	// dom('.view').render(data);
	dom('.view').render(data[1]);
	dom('.view').renderAfter(data);
	dom('.view').renderBefore(data[0]);
	// dom('#a').innerHTML=render(tpl,data)
	// console.log(render(tpl,data));

	// console.time('render');
	// console.log(render(tpl,data));
	// for(var i=0;i<10000;i++){ render(tpl,data) }
	// console.timeEnd('render');

	// console.time('render0');
	// console.log(render0(tpl,data));
	// for(var i=0;i<10000;i++){ render0(tpl,data) }
	// console.timeEnd('render0');

	// console.time('render1');
	// console.log(render1(tpl,data));
	// for(var i=0;i<10000;i++){ render1(tpl,data) }
	// console.timeEnd('render1');

// },0);
</script>

</body>
</html>